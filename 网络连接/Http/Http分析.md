## 1. HTTP简单介绍

HTTP是**HyperText Transfer Protocol**的简称，即超文本传输协议，通过HTTP协议，浏览器可以将网络中的文本、图片、视频等下载到本地中。

HTTP的内容主要分为三部分：

1. **HyperText**（超文本）： 

   超文本是一种概念，它通过超级链接方法将文本中的文字、图表与其他信息媒体相关联。HTML（超文本标记语言）就是在这种概念下诞生的一种文档格式，HTTP诞生之初就是为了传输HTML文档。

2. **Transfer**（传输）：

   1. 传输方式：HTTP底层使用TCP/IP协议传输数据

   2. 传输内容：

      HTTP一开始只是用于传输HTML文档，在增加了MIME（Multipurpose Internet Mail Extensions）后，可以用来传输图片、视频等文件

3. **Protocol**（协议）：协议指Http的传递，以及数据的一些约定和规范。例如Http报文需要有起始行、首部字段、以及主体。并且Http报文分为请求报文和响应报文，请求报文中起始行包含了URL、请求方式、Http版本，而响应报文的起始行则会包含Http版本、状态码。



## 2. HTTP版本介绍

### 2.1 HTTP1.0

Http1.0是第一个广泛使用的Http版本，在它之前还有一个Http0.9版本，Http0.9只支持GET方法，并且不支持各种多媒体内容，它的初衷只是为了获取HTML对象。而Http1.0增加了POST和HEAD方法，可以传输文字、图像、视频等，并且增加了各种Http首部字段

它有如下特点：

1. **无连接**

   **无连接**的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。

2. **无状态**

   **无状态**是指协议对于事务（指一次Http请求和一次Http响应）处理没有记忆能力，服务器不知道客户端是什么状态。即我们给服务器发送 HTTP 请求之后，服务器根据请求，会给我们发送数据过来，但是，发送完，不会记录任何信息。

3. 简单快速

   由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。

4. 灵活

   可以传输任意类型的数据对象，只需要通过Content-Type加以标记



Http1.0中无连接的特点在早期的时候是好的做法。由于浏览器与服务器的连接间歇性比较大，保持连接实际上占用了资源。而随着时间的推移，网页越来越复杂，可能嵌入了很多图片，每次图片的请求都需要建立一次连接就显得很低效。这时候很多主流的浏览器与服务器向Http协议中增加了许多特性，其中Keep-Alive使得Http连接持续有效。当然这是Http的非官方版本，一般称为Http1.0+。

即使用Http1.0时，我们可以在Http报文首部中，添加Connection:Keep-Alive，尝试保持连接状态，如果服务器响应的报文有相同的首部，则保持连接，如果没有，则客户端认为服务器不支持，就会关闭连接

### 2.2 HTTP1.1

Http1.1校正了Http1.0中的结构缺陷，明确语义，对性能进行优化，以及删除了一些不好的特性。

Http1.1的最大改变就是将持久化连接加入了Http标准。HTTP1.1持久连接在默认情况下是激活的，除非特别指明，否则HTTP/1.1假定所有的连接都是持久的，要在事务处理结束之后将连接关闭，HTTP1.1应用程序必须向报文中显示地添加一个Connection：close首部。

### 2.2 HTTP2.0

Http2.0相比Http1.1主要是性能上的优化，目前主流的还是Http1.1



## 3. HTTP的连接

1. 浏览器从URL中解析出服务器的主机名
2. 浏览器讲服务器的主机名转化成服务器的IP地址
3. 浏览器将端口号（如果有的话）从URL中解析出来
4. 浏览器建立一条与Web服务器的TCP连接
5. 浏览器向服务器发送一条HTTP请求报文
6. 服务器向浏览器发送一条HTTP响应报文
7. 关闭连接（如果添加了Connection：keep-alive 请求头，就保持连接）

## 4. HTTP的状态码

HTTP的状态码被分为五大类：

| 总体范围 | 定义范围 | 类别             |
| -------- | -------- | ---------------- |
| 100~199  | 100~101  | 信息类状态码     |
| 200~299  | 200~206  | 成功状态码       |
| 300~399  | 300~305  | 重定向状态码     |
| 400~499  | 400~415  | 客户端错误状态码 |
| 500~599  | 500~505  | 服务器错误状态码 |

### 4.1 1XX 信息类状态码

- 100 Continue（继续）

  收到了请求的起始部分，客户端应该继续请求

- 101 SwitchingProtocols （切换协议）

  服务器正根据客户端的指示将协议切换成Update首部字段列的协议

### 4.2 2XX 成功状态码

- 200 OK 

  服务器已成功处理请求

- 201 Created （已创建）

  对那些要服务器创建对象的请求来说，资源已创建完毕

- 202 Accepted（已接受）

  请求已接受，但服务器尚未处理

- 203 Non-Authoritative Information(非权威信息)

  服务器已将事务成功处理，只是实体首部包含的信息不是来自原始服务器，而是来自资源的副本

- 204 NoContent (没有内容)

  响应报文保函一些首部和一个状态行，但不包含实体的主体内容

- 205 ResetContent （重置内容）

  主要用于浏览器请求，表示浏览器应该重置当且页面上所有的HTML表单

### 4.3 3XX 重定向状态码

- 300 MultipleChoices（多项选择）

  客户端请求了实际指向多个资源的URL。这个状态码是和一个选项列表一起返回的，用户可以选择他希望使用的选项。

- 301 MovedPermanently（永久移除）

  请求的URL已移除。响应中应该包含一个Location ：URL，说明资源现在所处的位置

- 302 Found（已找到）

  请求的URL暂时移除，客户端应该用Location首部给出的URL对资源进行临时定位

- 303 See Other（参见其他）

  告诉客户端应该用另一个URL获取资源，这个新的URL位于响应报文的Location首部字段

- 304 Not Modified（未修改）

  客户端可以通过他们所包含的请求首部发起条件请求。说明资源没有发生过变化

- 305 UseProxy （使用代理）

  必须通过代理访问资源，代理的位置是在Location

- 306 （未使用）

- 307 Temporary Redirect （临时重定向）

  和状态码301类似，但客户端应该用Location首部给出的URL对资源进行临时定位

### 4.4 4XX 客户端错误状态码

- 400 Bad Request （坏请求）

  告诉客户端它发送了一条异常请求

- 401 Unauthorized（未授权）

  与适当的首部一起返回，在客户端获得访问权之前，请它进行身份认证

- 402 Payment Required （要求付款）

  当前此状态码并未使用，是为未来预留

- 403 Forbidden（禁止） 

  服务器拒绝了请求

- 404 Not Found（未找到）

  服务器无法找到请求的URL

- 405 Method Not Allowed（不允许使用的方法）

  请求中有一个所请求的URI不支持的方法，响应中应该包含一个Allow首部，以告诉客户端所请求的资源支持使用哪些方法

- 406 Not Acceptable（无法接受）

  客户端可以指定一些参数来说明希望接受哪些类型的实体。服务器没有资源与客户端可接受的URL相匹配时使用此状态码

- 407 Proxy Authentication Required（要求进行代理认证）

  和状态码401类似，但用于需要进行资源认证的代理服务器

- 408 Request Timeout

  如果客户端完成其请求时花费的时间太长，服务器可以回送这个状态码并关闭连接

- 409 Conflict (冲突)

  发出的请求在资源上造成了一些冲突

- 410 Gone （消失了）

  除了服务器曾持有这些资源之外，与状态码404类似

- 411 Length Required（要求长度指示）

  服务器要求在请求报文中包含Content-Length首部

- 412 Precondition Failed（先决条件失败）

  客户端发起一个条件请求，服务器无法满足其中的某个条件

- 413 Request Entity Too Large（请求实体太大）

  客户端发送的实体主体部分比服务器能够或者希望处理的要大

- 414 Request URI Too Long （请求URI太长）

  客户端发送的请求URL太长

- 415 Unsupported Media Type（不支持的媒体类型）

  服务器无法理解或不支持客户端所发送的实体的内容类型

- 416 Requested Range Not Satisfiable（所请求的范围未得到满足）

  请求报文请求的是某范围内的指定资源，但那个范围无效或者未得到满足

- 417 Expectation Failed （无法满足期望）

  请求的Expect 首部博阿寒了一个预期内容，但服务器无法满足

### 4.5 5XX 服务器错误状态码

- 500 Internal Server Error （内部服务器错误）

  服务器遇到了一个错误，使其无法为请求提供服务

- 501 Not Implemented （未实现）

  服务器无法满足客户端请求的某个功能

- 502 Bad Gateway（网关故障）

  作为代理或网关使用的服务器遇到了来自响应链中上游的无效响应

- 503 Service Unavailable（未提供此服务）

  服务器目前无法未请求提供服务，但是过段时间就看与恢复服务

- 504 Gateway Timeout（网关超时）

  网关或代理在等待服务器的响应时出现超时

- 505 HTTP Version Not Supported （不支持的HTTP版本）

  服务器收到的请求是以它不支持或不愿支持的协议版本表示的









